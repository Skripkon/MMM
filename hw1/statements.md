# ДЗ №1 Мультимодальный поиск похожих произведений искусства

Представьте: вы пришли в музей или пролистываете онлайн-галерею и находите картину, которая вам особенно нравится.
Возникает естественный вопрос: **а какие ещё произведения похожи на неё?** Может быть, по стилю мазка, по жанру, по настроению, по сюжету. Или, наоборот, хочется задать текстовый запрос — «брейнрот в стиле импрессионизма» — и найти визуально близкие работы. А иногда достаточно одного-двух тегов, чтобы быстро собрать подборку картин в нужной тематике.

Это и есть **мультимодальный поиск**: умение находить объекты в коллекции не только по изображению в качестве запроса, но и по тексту, и по семантическим признакам.  
В этом задании мы сделаем прототип рекомендательной системы для художественных произведений, которая работает сразу на нескольких уровнях:

1. **Image→Image Retrieval** — поиск визуально похожих картин по эмбеддингам.  
2. **Caption→Image Retrieval** — поиск картин по автоматически сгенерированным описаниям (caption).  
3. **Omni→Image Retrieval** — поиск по запросу, жанрам, стилям и прочим тегам, полученным Zero-Shot классификацией.  

Вам необходимо реализовать MVP системы рекомендаций для искусства, где объединяются разные модальности: изображения, текст и мета-информация.  Такой же принцип лежит в основе реальных поисковых и рекомендательных сервисов в индустрии (музыка, видео, маркетплейсы, соцсети).

**Что важно в этой работе:**  
- Понять, как связаны разные модальности через эмбеддинги.  
- Научиться строить индексы и реализовывать поиск.  
- Сгенерировать и опубликовать свои артефакты (caption, лейблы).  
- Критически оценить качество и ограничения.  
- Бонусом — сделать интерактивный сервис, который можно продемонстрировать коллегам и пользоваться самостоятельно.


## Датасет

Для экспериментов мы будем использовать датасет **[WikiArt](https://huggingface.co/datasets/huggan/wikiart)**.  
В нём собраны тысячи картин разных художников, стилей и направлений.

Для экспериментов и построения индексов в целях ускорения вы можете выбрать подвыборку всего датасета (не менее 5000), но явно зафиксируйте это в вашем решении, если будете делать так. Аналогично, вы можете выбрать другой датасет, который подошел бы для выполнения целевых заданий, описанных ниже.

## Задание

### 1. Image→Image Retrieval · до 3 баллов
- **1 балл**: выбор image-encoder и мотивация (почему именно эта модель, продемонстрировать, как получить с помощью нее эмбеддинг изображения).  
- **1 балл**: построение индекса (например, FAISS).  
- **1 балл**: демонстрация работы (показать топ-10 ближайших картин к выбранной для 10 разнообразных примеров).  

### 2. Caption→Image Retrieval · до 3 баллов
- **1 балл**: выбор модели для captioning и описание инференса.  
- **1 балл**: примеры сгенерированных caption (показать в ноутбуке).  
- **1 балл**: реализация и демонстрация работы индекса на основе caption (показать топ-10 ближайших картин к выбранной для 10 разнообразных примеров).
- **1 балл**: публикация датасета с caption на HuggingFace Datasets (например json/csv с полями `image_row`, `caption`, сами изображения загружать не обязательно).  

### 3. Omni→Image Retrieval · до 4 баллов
- **1 балла**: генерация Zero-Shot признаков с помощью VLM.  
- **3 балл**: реализация поиска на основе текстового запроса, жанров, дополнительных признаков. Добавьте возможность поиска изображений различными способами, утилизирующими полученную суррогатную разметку и разные модальности.

### Бонусная часть · до +3 баллов
Реализовать демо (Gradio/Streamlit/Telegram-бот) на основе полученного решения и индексов, по +1 за добавление каждого из описанных выше функционалов в демо.

Ноутбук долден быть воспроизводим, внутри отрисованы все результаты последовательного исполнения ячеек, все шаги подробно аннотированы, датасеты и демо публично доступны.
